#!/usr/bin/env python

import subprocess

from .add_to_database import *

def save_labels(id_malware):

    """Save the label avclass report.
    Params:
    - id+malware
    Returns:
    -
    """
    p = subprocess.Popen(['python3', 'avclass_labeler.py', '-vt', str(id_malware) + '.vt'], stdout=subprocess.PIPE)
    out, err = p.communicate()
    if str(out) == "b''":
      return
    elif "SINGLETON" in str(out):
      out = "singleton"
    else:
        out = str(out).split('\\')[1][1:]
    add_label_collection(str(id_malware), out)
    print("\navclassplusplus label for malware " + str(id_malware) + " output added")

